<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analytics | Orion Taskworks</title>

<!-- Bootstrap CSS for layout -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

<!-- Custom CSS including dark mode -->
<link rel="stylesheet" href="styles.css">

<!-- jQuery for DOM manipulation -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Chart.js for analytics charts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    body {
      padding-bottom: 80px; /* Keeps content visible above fixed footer */
    }
  </style>
</head>
<body>

<!-- ============================== -->
<!-- NAVBAR -->
<!-- ============================== -->
<header>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
  <div class="container-fluid">
    <a class="navbar-brand" href="index.html">Orion Taskworks</a>
    <img src="logo.png" alt="Orion Taskworks Logo" width="50" height="50" class="d-inline-block align-text-top me-2">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="tasks.html">Tasks</a></li>
        <li class="nav-item"><a class="nav-link active" href="analytics.html">Analytics</a></li>
        <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
        <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
        <li class="nav-item"><a class="nav-link" href="fake.html">fake</a></li>
      </ul>

      <!-- Dark Mode Toggle -->
      <div class="form-check form-switch ms-3">
        <input class="form-check-input" type="checkbox" id="darkModeToggle">
        <label class="form-check-label text-white" for="darkModeToggle">Dark Mode</label>
      </div>
    </div>
  </div>
</nav>
</header>

<main class="container mt-5 pt-5">

<h1 class="text-center mb-8">Task Analytics Dashboard</h1>
<p class="text-center mb-8">Visualize task completion and priorities for better planning.</p>

<!-- ============================== -->
<!-- SUMMARY CARDS -->
<!-- ============================== -->
<div class="row g-4 mb-5">
  <div class="col-md-4">  
    <div class="card text-center shadow-sm">
      <div class="card-body">
        <h5 class="card-title">Total Tasks</h5>
        <p class="card-text fs-3" id="totalTasks">0</p>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card text-center shadow-sm">
      <div class="card-body">
        <h5 class="card-title">Completed Tasks</h5>
        <p class="card-text fs-3 text-success" id="completedTasks">0</p>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card text-center shadow-sm">
      <div class="card-body">
        <h5 class="card-title">Pending Tasks</h5>
        <p class="card-text fs-3 text-warning" id="pendingTasks">0</p>
      </div>
    </div>
  </div>
</div>

<!-- ============================== -->
<!-- CHARTS SECTION -->
<!-- ============================== -->
 <div class="row g-4">
  <div class="col-md-4">  <!-- changes chart size-->
    <div class="card shadow-sm p-3" >
      <h5 class="text-center mb-3"  >Completed vs Pending</h5>
      <canvas id="statusChart" ></canvas>
    </div>
  </div>  
  <div class="col-md-6">
    <div class="card shadow-sm p-3">
      <h5 class="text-center mb-3">Tasks by Priority</h5>
      <canvas id="priorityChart"></canvas>
    </div>
  </div>
</div>  

</main>

<!-- ============================== -->
<!-- FOOTER -->
<!-- ============================== -->
<footer class="bg-dark text-white text-center py-3 fixed-bottom">
  <p>&copy; 2025 Orion Taskworks | Analytics Page</p>
</footer>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- Dark mode JS -->
<script src="js/darkmode.js"></script>

<!-- ============================== -->
<!-- ANALYTICS JS -->
<!-- ============================== -->
<script>
$(document).ready(function() {
  // Load tasks from localStorage
  const tasks = JSON.parse(localStorage.getItem('tasks')) || [];

  // Compute summary stats
  const totalTasks = tasks.length;
  const pendingTasks = tasks.filter(t => t.status === 'Pending').length;
  const completedTasks = totalTasks - pendingTasks;

  // Count tasks by priority
  const priorities = { High: 0, Medium: 0, Low: 0 };
  tasks.forEach(t => { priorities[t.priority] = (priorities[t.priority] || 0) + 1; });

  // Update summary cards
  $('#totalTasks').text(totalTasks);
  $('#completedTasks').text(completedTasks);
  $('#pendingTasks').text(pendingTasks);

  // ==============================
  // Completed vs Pending Pie Chart
  // ==============================
  const statusCtx = document.getElementById('statusChart').getContext('2d');
  new Chart(statusCtx, {
    type: 'pie',
    data: {
      labels: ['Completed', 'Pending'],
      datasets: [{
        data: [completedTasks, pendingTasks],
        backgroundColor: ['#28a745', '#ffc107']
      }]
    },
    options: {
      responsive: true,
      plugins: { legend: { position: 'bottom' } }
    }
  });

  // ==============================
  // Priority Distribution Bar Chart
  // ==============================
  const priorityCtx = document.getElementById('priorityChart').getContext('2d');
  new Chart(priorityCtx, {
    type: 'bar',
    data: {
      labels: Object.keys(priorities),
      datasets: [{
        label: 'Number of Tasks',
        data: Object.values(priorities),
        backgroundColor: ['#dc3545','#ffc107','#0d6efd']
      }]
    },
    options: {
      responsive: true,
      plugins: { legend: { display: false } },
      scales: { y: { beginAtZero: true, precision:0 } }
    }
  });
});
</script>
</body>
</html>
